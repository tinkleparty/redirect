<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>English Assignment</title>
<style>
body {
  background-color: black;
  margin: 0;
  font-family: Arial, sans-serif;
  overflow-x: hidden;
  display: flex;
}

/* --- Announcement --- */
#announcement-banner {
  width: 100%;
  background: linear-gradient(90deg, #333333, #1a1a1a);
  color: white;
  text-align: center;
  padding: 15px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  position: fixed;
  top: 0;
  left: 0;
  z-index: 999;
  border-bottom: 1px solid #444;
}
#announcement-banner:hover {
  opacity: 0.9;
  background: linear-gradient(90deg, #444, #222);
}
  
/* --- Sidebar --- */
#sidebar {
  position: fixed;
  top: 60px;
  left: 0;
  width: 200px;
  background-color: #111;
  height: calc(100vh - 60px);
  border-right: 1px solid #333;
  padding-top: 20px;
  overflow-y: auto;
}
.sidebar-item {
  color: white;
  padding: 12px 20px;
  cursor: pointer;
  transition: background 0.3s;
}
.sidebar-item:hover,
.sidebar-item.active { background-color: #333; }

/* --- Main Container --- */
#container {
  margin-left: 200px;
  margin-top: 60px;
  background-color: #1a1a1a;
  padding: 20px;
  border-radius: 15px;
  box-shadow: 0 0 10px rgba(255,255,255,0.2);
  max-width: calc(100% - 220px);
  min-height: calc(100vh - 80px);
  flex: 1;
}

h2 {
  color: white;
  text-align: center;
  margin-bottom: 10px;
}

#search-bar {
  width: 80%;
  padding: 10px;
  font-size: 16px;
  border-radius: 8px;
  border: none;
  margin: 0 auto 25px;
  outline: none;
  display: block;
  text-align: center;
}

/* --- Game Gallery Layout --- */
#games {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 25px;
  padding-bottom: 50px;
}

/* --- Game Card --- */
.game-card {
  position: relative;
  background-color: #222;
  border-radius: 20px;
  overflow: hidden;
  box-shadow: 0 0 8px rgba(255,255,255,0.1);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  width: 180px;
  height: 240px;
  display: flex;
  flex-direction: column;
  align-items: center;
}
.game-card:hover {
  transform: scale(1.05);
  box-shadow: 0 0 15px rgba(255,255,255,0.3);
}
.game-card img {
  width: 160px;
  height: 160px;
  object-fit: cover;
  border-radius: 15px;
  margin-top: 10px;
}
.game-name {
  color: white;
  font-size: 14px;
  font-weight: bold;
  margin: 8px 0 5px;
}
.get-code {
  padding: 6px 14px;
  border-radius: 10px;
  background-color: #4CAF50;
  color: white;
  border: none;
  cursor: pointer;
  font-size: 12px;
  opacity: 0.9;
}
.get-code:hover { background-color: #45a049; }

/* --- Rank Badges --- */
.rank-badge {
  position: absolute;
  top: 8px;
  left: 8px;
  font-weight: bold;
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 12px;
  color: black;
  animation: pulse 1.2s infinite alternate;
}
@keyframes pulse {
  from { transform: scale(1); }
  to { transform: scale(1.15); }
}
.rank-gold   { background: linear-gradient(45deg, gold, #ffda73); box-shadow: 0 0 12px gold; }
.rank-silver { background: linear-gradient(45deg, #c0c0c0, #eeeeee); box-shadow: 0 0 12px #ccc; }
.rank-bronze { background: linear-gradient(45deg, #cd7f32, #e6a96f); box-shadow: 0 0 12px #cd7f32; }
.rank-blue   { background: linear-gradient(45deg, #00bfff, #80e0ff); box-shadow: 0 0 12px #00bfff; }

/* --- Notification --- */
#notification {
  position: fixed;
  top: 20px;
  right: 20px;
  padding: 15px;
  border-radius: 10px;
  color: white;
  font-size: 14px;
  display: none;
  z-index: 1000;
}
.success { background-color: #4CAF50; }
.error { background-color: #f44336; }

.form-container {
  width: 360px;
  background: linear-gradient(#1a1a1a, #1a1a1a) padding-box,
              linear-gradient(145deg, transparent 35%, #e81cff, #40c9ff) border-box;
  border: 2px solid transparent;
  padding: 32px 26px;
  font-size: 14px;
  color: white;
  display: flex;
  flex-direction: column;
  align-items: center;
  border-radius: 18px;
  box-shadow: 0 0 25px rgba(232, 28, 255, 0.3);
  margin: 60px auto;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.form-container:hover {
  transform: scale(1.02);
  box-shadow: 0 0 35px rgba(64, 201, 255, 0.4);
}

.form-title {
  font-size: 18px;
  font-weight: 600;
  color: #fff;
  text-align: center;
  margin-bottom: 22px;
}

.form {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
  width: 100%;
}

.form-group {
  width: 80%;
  display: flex;
  flex-direction: column;
}

.form-group input {
  width: 90%;
  padding: 12px 14px;
  border-radius: 10px;
  color: #fff;
  background-color: transparent;
  border: 1px solid #444;
  text-align: center;
  font-size: 14px;
  transition: border 0.2s, box-shadow 0.2s;
}
.form-group input::placeholder {
  color: #888;
}
.form-group input:focus {
  outline: none;
  border-color: #e81cff;
  box-shadow: 0 0 10px rgba(232, 28, 255, 0.3);
}

.form-submit-btn {
  color: #ccc;
  font-weight: 600;
  background: #212121;
  border: 1px solid #414141;
  padding: 10px 20px;
  border-radius: 10px;
  cursor: pointer;
  width: 50%;
  transition: all 0.25s ease;
}
.form-submit-btn:hover {
  background: linear-gradient(90deg, #e81cff, #40c9ff);
  color: white;
  border-color: transparent;
  box-shadow: 0 0 15px rgba(64, 201, 255, 0.4);
}
</style>
</head>
<body>

<div id="announcement-banner" onclick="window.open('https://tinkleparty.github.io/redirect/', '_blank')">
  üì¢ Enter Codes Here!
</div>
  
<!-- SIDEBAR -->
<div id="sidebar">
  <div class="sidebar-item active" data-category="all">All Games</div>
  <div class="sidebar-item" data-category="popular">‚≠ê Most Popular</div>
  <div class="sidebar-item" data-category="new">üÜï New Games</div>
  <div class="sidebar-item" data-category="action">‚öîÔ∏è Action</div>
  <div class="sidebar-item" data-category="horror">üëª Horror</div>
  <div class="sidebar-item" data-category="arcade">üïπÔ∏è Arcade</div>
  <div class="sidebar-item" data-category="puzzle">üß© Puzzle</div>
  <div class="sidebar-item" data-category="simulator">üè≠ Simulator</div>
  <div class="sidebar-item" data-category="request">üéÆ Request Games</div>
  <div class="sidebar-item" id="movies-btn">üé¨ Movies</div>
</div>

<!-- MAIN -->
<div id="container">
  <h2 id="category-title">All Games</h2>
  <input id="search-bar" type="text" placeholder="üîç Search games..." />
  <div id="games">
    <div class="game-card" data-code="CODES">
      <p class="game-name">This Page</p>
      <img src="https://raw.githubusercontent.com/Nawsomey/images/refs/heads/main/IMG_2756.jpeg" alt="This Page">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="FUN" data-category="horror">
      <p class="game-name">FeedVid Live</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT7ODvZa5aAF8Hj8nWOrVcIGgolUgeqIgbL4A&s" alt="FeedVid Live">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="RACCOON" data-category="arcade">
      <p class="game-name">Tanuki Sunset</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR6xVpwHBAogwVdiqlsfh8m_1dsP0okrOH6VA&s" alt="Tanuki Sunset">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="POLY" data-category="arcade">
      <p class="game-name">PolyTrack</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTN-a70X18WcY1jVzgEhMPJwvlxXqpqXzd8qg&s" alt="PolyTrack">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="VAMP" data-category="action">
      <p class="game-name">Vampire Survivors</p>
      <img src="https://play-lh.googleusercontent.com/R1dShZj1HNBQzrHhsAD9_F8BRc2FU-nlDMU7OIAIwnMge04QWvNZR-clnXnEd_v30Qo" alt="Vampire Survivors">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="SCARY" data-category="horror">
      <p class="game-name">Delivery Mystery</p>
      <img src="https://i.ytimg.com/vi/EGPrR_zt0YM/hq720.jpg?sqp=-oaymwEhCK4FEIIDSFryq4qpAxMIARUAAAAAGAElAADIQj0AgKJD&rs=AOn4CLA-xjmqx4XqaYi9o9DPni3H-CNs4w" alt="Burger & Frights">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="KING" data-category="puzzle">
      <p class="game-name">Sort the Court!</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcScw_aOzrTL5nvkw15Rax6nPjHYUzsg3pEugA&s" alt="Sort the Court!">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="FRUIT" data-category="arcade">
      <p class="game-name">Fruit Ninja</p>
      <img src="https://cdn.jim-nielsen.com/ios/512/fruit-ninja-2020-08-31.png?rf=1024" alt="Fruit Ninja">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="BOW" data-category="arcade">
      <p class="game-name">Bowmasters</p>
      <img src="https://play-lh.googleusercontent.com/rsQyCuie6S8Munc2Hv6IMpePP1g3c0okLkyKRXd1IimOryIBMZqymGKaOg7bZ6NMkhj3=w240-h480-rw" alt="Bowmasters">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="CROSSY" data-category="arcade">
      <p class="game-name">Crossy Roads</p>
      <img src="https://upload.wikimedia.org/wikipedia/en/7/71/Crossy_Road_icon.jpeg" alt="Crossy Roads">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="DRAW" data-category="arcade">
      <p class="game-name">Draw Climbers</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTIfT8Z8cWUjy_YmipolVtNkYFCup2u2ziVOnNuFK3fQpmoKFyN4fn43uynMSDe2pZypjQ&usqp=CAU" alt="Draw Climbers">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="TOMB" data-category="arcade">
      <p class="game-name">Tomb Of The Mask</p>
      <img src="https://play-lh.googleusercontent.com/ATGr-U4JBK2VjFzKGK9eMMkrDxJaazadOUoz_7Yl0U5NrWSFcFUzEtNurWXYzVWc8uOO=w240-h480-rw" alt="Tomb Of The Mask">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="COOKIE" data-category="simulator">
      <p class="game-name">Cookie Clicker</p>
      <img src="https://play-lh.googleusercontent.com/Z1MOuuiD05ZN5LkVmMEvKF0mqAc-FknaQ2j8s4dZiO-LSPQX4EEA3RVJdlQEtxe96ok" alt="Cookie Clicker">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="DR3D" data-category="arcade">
      <p class="game-name">Death Run 3D</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQmy73hHHgqrJSvDJyUYr3niFBHo5oo3JFHCg&s" alt="Death Run 3D">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="BALDI" data-category="horror">
      <p class="game-name">Baldi‚Äôs Basics</p>
      <img src="https://play-lh.googleusercontent.com/EPV1TB4So1lB0DGrdCVExDpNU8ML67nd8OqBeoOIM-s6sDicxmDdPvCXD6n7LKevFl0" alt="Baldi‚Äôs Basics">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="SLOPE" data-category="arcade">
      <p class="game-name">Slope</p>
      <img src="https://play-lh.googleusercontent.com/uJn2i9h7KxYQarC_c3K4qH6o7gLtflFnhD_dN14MNkzHJ1NeNFzCL69jpB5mT0vCoQs" alt="Slope">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="DRIVE" data-category="arcade">
      <p class="game-name">Drive Mad</p>
      <img src="https://play-lh.googleusercontent.com/7l3WAPbei9MXrxnCzImpXi2VxjEBtgDl0htwvTnA-YqpJAuQJPpSiby1oB8LZMgD0IAy" alt="Drive Mad">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="FNAF1" data-category="horror">
      <p class="game-name">FNAF 1</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQbMsflA8XZ_FHsEuThoO4aUC8utbvS24B9zw&s" alt="FNAF 1">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="JET" data-category="arcade">
      <p class="game-name">Jetpack Joyride</p>
      <img src="https://play-lh.googleusercontent.com/3e_iyy1dolGSHqKFmwsao8SiMmqOtCuwD4CyKToLHoK34cchcH5PlG2VhOoE2_j-7FMH" alt="Jetpack Joyride">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="MART" data-category="arcade">
      <p class="game-name">Monkey Mart</p>
      <img src="https://play-lh.googleusercontent.com/rWReIdyvDaYJPeOxn7hbC0b-96ixGpQKM_EndiQa3SUME8TtI_rNUcI4qsw5teK9mqk" alt="Monkey Mart">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="SUBWAY" data-category="arcade">
      <p class="game-name">Subway Surfers</p>
      <img src="https://w7.pngwing.com/pngs/416/401/png-transparent-subway-surfers-smash-champs-android-kiloo-subway-surfer-hand-computer-wallpaper-cartoon-thumbnail.png" alt="Subway Surfers">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="SUPERHOT" data-category="arcade">
      <p class="game-name">SUPERHOT</p>
      <img src="https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/i/a6e74472-2425-4077-817c-55d42cee8697/dd2eu62-f3c6ca09-35fb-42c8-b360-1ddd7ef02fde.png/v1/fill/w_512,h_512,q_80,strp/superhot_icon__by_iconinja__by_iconinja_dd2eu62-fullview.jpg" alt="SUPERHOT">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="VEX4" data-category="arcade">
      <p class="game-name">Vex 4</p>
      <img src="https://images.dwncdn.net/images/t_app-icon-l/p/62c971a1-12be-478d-8207-57dbb4e28ff4/1993335666/2095_4-78353669-imgingest-7238314859016812313.png" alt="Vex 4">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="VEX5" data-category="arcade">
      <p class="game-name">Vex 5</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSHjyEdV0TwjMEn7tppjneB1C7aJrfzTt6lSQ&s" alt="Vex 5">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="VEX6" data-category="arcade">
      <p class="game-name">Vex 6</p>
      <img src="https://www.mathnook.com/img/addthis-fun-games/vex-6-200x200.png" alt="Vex 6">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="VEX7" data-category="arcade">
      <p class="game-name">Vex 7</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR-Qisw8oFkf2bTtLnplda1Bs8M5V-Gfcgwfw&s" alt="Vex 7">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="VEX8" data-category="arcade">
      <p class="game-name">Vex 8</p>
      <img src="https://play-lh.googleusercontent.com/4tQSYur7SAvXeEvT5GBugYeqbh8KEQSLd1S16t8CJYyDN3g2p27wiPlXnqqAxeCqvg" alt="Vex 8">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="DRIFT" data-category="arcade">
      <p class="game-name">Drift Boss</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTS3Uh0wryQixfAEMiPLynShMYSlv9WO3SC45eEJ9MQxgwRbUo9UePjxNzR_292WwaY02I&usqp=CAU" alt="Drift Boss">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="TEMPLE" data-category="arcade">
      <p class="game-name">Temple Run 2</p>
      <img src="https://play-lh.googleusercontent.com/go4XqS4mYs-G2tZymiVLF4wJYXIi5QrvwixNRzssk4G_vRBHrAdg4E1ddNwy9c2cZA" alt="Temple Run 2">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="RETROBOWL" data-category="arcade">
      <p class="game-name">Retro Bowl</p>
      <img src="https://upload.wikimedia.org/wikipedia/en/b/bf/Retro_Bowl_cover.png" alt="Retro Bowl">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="MARIO" data-category="arcade">
      <p class="game-name">Super Mario Bros</p>
      <img src="https://m.media-amazon.com/images/I/91MTy%20J%201AL.jpg" alt="Super Mario Bros">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="PACMAN" data-category="arcade">
      <p class="game-name">Pac-Man</p>
      <img src="https://images.macrumors.com/t/_7Hg0kpdvBZoD-ePhjPhkYMU_hk=/1600x/article-new/2014/01/pacman.jpg" alt="Pac-Man">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="RUN3" data-category="arcade">
      <p class="game-name">Run 3</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTqt84hsOmA1pbIydI7PvRVHS3eytJRQB5hdQqMO2BXOPBexAxUEFxKdoIGt2JkdImMGEU&usqp=CAU" alt="Run 3">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="STICKHOOK" data-category="arcade">
      <p class="game-name">Stickman Hook</p>
      <img src="https://play-lh.googleusercontent.com/yXqBI1Vb1b-xjwmXLE2T7FQbgHIxfvjze1b6jO2aLHfy8Y8ta7NFSEVqZoPHtM2Ajyrl" alt="Stickman Hook">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="MINECRAFT" data-category="action">
      <p class="game-name">Minecraft</p>
      <img src="https://i.pinimg.com/736x/6c/96/33/6c9633545ac521e641fb481c19d80a8d.jpg" alt="Minecraft">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="SL2" data-category="action">
      <p class="game-name">Short Life 2</p>
      <img src="https://img.poki-cdn.com/cdn-cgi/image/q=78,scq=50,width=314,height=314,fit=cover,f=auto/ba38f1297873d106903997a184dbe536/short-life-2.png" alt="Short Life 2">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="BITLIFE" data-category="simulator">
      <p class="game-name">BitLife</p>
      <img src="https://play-lh.googleusercontent.com/fUM-UyywXxjC8soxAZdIlxJrlRRXmql8wkE426SHzft4lJycSKVd2jCYQQX1BEG9Xw" alt="BitLife">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="MURDER" data-category="puzzle">
      <p class="game-name">Murder</p>
      <img src="https://play-lh.googleusercontent.com/BT7zrf4JNZj4pRV5YIRT4D0DydkuLEzVvnOwKmmOxuc1sbIUJyZbeaFOhjuLK4CXWFg" alt="Murder">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="FNF" data-category="arcade">
      <p class="game-name">Friday Night Funkin'</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRsl2Wte_Hp5jrGNRJ3XNIIVa9zB0vO8y54Ig&s" alt="Friday Night Funkin'">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="TING" data-category="puzzle">
      <p class="game-name">There Is No Game</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTHriUJw61GtIpLXWLU3i6tgPuUEHFOJvwAHg&s" alt="There Is No Game">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="RS1" data-category="puzzle">
      <p class="game-name">Riddle School 1</p>
      <img src="https://flashmuseum.org/wp-content/uploads/2023/06/Riddle-School_logo.png" alt="Riddle School 1">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="RS2" data-category="puzzle">
      <p class="game-name">Riddle School 2</p>
      <img src="https://flashmuseum.org/wp-content/uploads/2023/05/Riddle-School-2_logo.png" alt="Riddle School 2">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="3DASH" data-category="arcade">
      <p class="game-name">3D Geometry Dash</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRFI2wUNUP3Nkl5pT2uxXQtlLTFes0hzx1MExk4FVVQS2TMnue85KpoMx5CuPWynSA_7kM&usqp=CAU" alt="3D Geometry Dash">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="1V1LOL" data-category="action">
      <p class="game-name">1v1.lol</p>
      <img src="https://www.metacritic.com/a/img/catalog/provider/6/12/6-1-758332-52.jpg" alt="1v1.lol">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="GRANNY" data-category="horror">
      <p class="game-name">Granny</p>
      <img src="https://play-lh.googleusercontent.com/yT_LBq_tyKeIDohKDsqN_Qt18jGIPUYIxY2C-1-E2YA9Qd60uZW08pua17qBmIiDPA" alt="Granny">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="GRANNY2" data-category="horror">
      <p class="game-name">Granny 2</p>
      <img src="https://play-lh.googleusercontent.com/iZ7NP-56YenT2dpgKEAw3n7IKFyu-S_9Iu3ayo28XYTgZpFtxsK_HXltV36pysSJqq8=w240-h480-rw" alt="Granny 2">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="BOBLOX" data-category="arcade">
      <p class="game-name">Roblox Obby?</p>
      <img src="https://cdna.artstation.com/p/assets/images/images/080/886/112/large/outmou-parkor-1.jpg?1728814579" alt="Roblox Obby?">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="GUNSPIN" data-category="arcade">
      <p class="game-name">Gun Spin</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTei07pjTSWlXal0yIdqvTJLZpaoRVwblLSZA&s" alt="Gun Spin">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="HELIX" data-category="arcade">
      <p class="game-name">Helix Jump</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ7zftHcojlrv0v8q63HaVh0JE9ckf1f2hJOg&s" alt="Helix Jump">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="HOH" data-category="puzzle">
      <p class="game-name">House of Hazards</p>
      <img src="https://img.poki-cdn.com/cdn-cgi/image/q=78,scq=50,width=314,height=314,fit=cover,f=auto/0609b0ba2889859b21cf47ca205818fe/house-of-hazards.png" alt="House of Hazards">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="PAPERIO2" data-category="arcade">
      <p class="game-name">Paper.io 2</p>
      <img src="https://play-lh.googleusercontent.com/SWTpYqsX9RN2YirCDnAjQ8qsbgn4UrHkRRGsjwuASnHMVqssIvWKzq82mP82y_ffBSE" alt="Paper.io 2">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="STUNT" data-category="action">
      <p class="game-name">Stunt Car 3</p>
      <img src="https://play-lh.googleusercontent.com/c3vpzjSr0_uxvmBvDJDMtDTSmla8wQeaSWDEn_pb92fHkD1AXSKLcrXDTxnULlAarlA=w240-h480-rw" alt="Stunt Car 3">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="WATERMELON" data-category="arcade">
      <p class="game-name">Watermelon Go!</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSzLBURxABwy5kMo_GQIT0uTJtgJ1slvo1Egw&s" alt="Watermelon Go!">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="TINYFISH" data-category="arcade">
      <p class="game-name">Tiny Fishing</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSFxZAeqObxw3k1vtmdAeWJ9WDgcqjFhLbmiQ&s" alt="Tiny Fishing">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="BOOTY" data-category="arcade">
      <p class="game-name">Grow a big butt</p>
      <img src="https://play-lh.googleusercontent.com/WzQkzhon86ognNoTWKPm8P0-eKboEW-xjQWInhEYr8SFOIit45kdRDPbGzOdJkZiSA" alt="Grow a big butt">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="GLADI" data-category="arcade">
      <p class="game-name">Gladihoppers</p>
      <img src="https://play-lh.googleusercontent.com/HUuFbIPERNbpW2Q72WIqiJ8bKDzIgT_C4PnYvMBuH0wC3B_KvpKmumm1FXhZj3jmRHw" alt="Gladihoppers">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="RB4" data-category="arcade">
      <p class="game-name">Red Ball 4</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTi3Qa6MBbp6f1tobkXqjWwRA4Jbrr-ovjWww&s" alt="Red Ball 4">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="BLOCK" data-category="arcade">
      <p class="game-name">Block Blast</p>
      <img src="https://play-lh.googleusercontent.com/R0qgNDYYHbRhw6JFsdEbDMqONplEvJx0m0W9wzYVvY3eNF1c2rfBWYjQxW0sLEzFe1E=w600-h300-pc0xffffff-pd" alt="Block Blast">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="FPS" data-category="action">
      <p class="game-name">Station Saturn</p>
      <img src="https://img.itch.zone/aW1nLzExNDMzMzU2LnBuZw==/original/IvErVH.png" alt="Station Saturn">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="PLINKO" data-category="arcade">
      <p class="game-name">Plinko RNG</p>
      <img src="https://discord.do/wp-content/uploads/2025/04/Plinko-RNG-Discord-server.jpg" alt="Plinko RNG">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="HS1" data-category="puzzle">
      <p class="game-name">Henry Stickmin: Breaking the Bank</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ0Ubpi6WS3zxmQmDuAKjCNa4lvRROR0-zRPwCizWiXsD5Vz5Oac2mpbI3oIoY9dTGPYkY&usqp=CAU" alt="Henry Stickmin: ">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="HS2" data-category="puzzle">
      <p class="game-name">Henry Stickmin: Escaping the Prison</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR1aUHlWz3XXEO-kDdmVL8XhqQIIW6X8jbgitAN12x9nD_nV02SnW_5NDZPPJrzNoSDGX4&usqp=CAU" alt="Henry Stickmin: ">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="HS3" data-category="puzzle">
      <p class="game-name">Henry Stickmin: Stealing the Diamond</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRoZ9WucAFbmhxRz0ZgNMZ81FRKJzN_vljTLQ&s" alt="Henry Stickmin: ">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="HS4" data-category="puzzle">
      <p class="game-name">Henry Stickmin: Infiltrating the Airship</p>
      <img src="https://m.media-amazon.com/images/I/61Xvr2hpCiL.png" alt="Henry Stickmin: ">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="HS5" data-category="puzzle">
      <p class="game-name">Henry Stickmin: Fleeing the Complex</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS_F0vrDsQnVgc3KSuofz9N1MvNH_7-SB38TslA_schtzNDV_fQQ7Oq23rZVYdJ7ZRqfKk&usqp=CAU" alt="Henry Stickmin: ">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="RW1" data-category="action">
      <p class="game-name">Raft Wars 1</p>
      <img src="https://img.poki-cdn.com/cdn-cgi/image/q=78,scq=50,width=314,height=314,fit=cover,f=auto/d2a3bbd1bb8aea542835f4f8a353d388/raft-wars.png" alt="Raft Wars 1">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="RW2" data-category="action">
      <p class="game-name">Raft Wars 2</p>
      <img src="https://play-lh.googleusercontent.com/lDc6_9GqbCXhsp6MHTPOtK8y1LxZz8pj0azRHLgRImBWHXTkhw_0hlT1XGyeP7lwn8k" alt="Raft Wars 2">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="BUCKSHOT" data-category="horror">
      <p class="game-name">Buckshot Roulette</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQFP-TxRuSQphlOWAHiCJUBxcJvCY6OQCZP5UCJg5u3aYZRD5WaI8relaMeqhyh5iVVyHo&usqp=CAU" alt="Buckshot Roulette">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="BENDY" data-category="horror">
      <p class="game-name">Bendy and the Ink Machine</p>
      <img src="https://play-lh.googleusercontent.com/96eBM7bUrouYRKa_1k3d2inqHMNJp25BX4IeGbpHdhvOYjLjqFn4upD2wEwGPsOBh2oz" alt="Bendy and the Ink Machine">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="KD1" data-category="puzzle">
      <p class="game-name">Kindergarten</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQGk5w2F3GS50MGMBlKNW6rGrK-LX5S6o-MKMe1-oJGm_71dGXcSYBUXCp770a9TC4AIl8&usqp=CAU" alt="Kindergarten">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="KD2" data-category="puzzle">
      <p class="game-name">Kindergarten 2</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT04MA00rFwaXlt7-k3TyPy2DPrdDXfJJ698w&s" alt="Kindergarten 2">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="KD3" data-category="puzzle">
      <p class="game-name">Kindergarten 3</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRzg5WOrTQbjBPdoAzapsgf3POEreUEK1YXaA&s" alt="Kindergarten 3">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="REPO" data-category="horror">
      <p class="game-name">R.E.P.O.</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR7erpTVvLl3jcjJOcvizpDTMAPPKyLGaaLIA&s" alt="R.E.P.O.">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="TILES" data-category="arcade">
      <p class="game-name">Magic Tiles 3</p>
      <img src="https://play-lh.googleusercontent.com/u94NKpNjH1sBOiKHevX3_ATM-ozNHg6b186oU9GfnPnHwbdJ7RaeipkCRcVPdf1KRA" alt="Magic Tiles 3">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="GD" data-category="arcade">
      <p class="game-name">Geometry Dash Lite</p>
      <img src="https://play-lh.googleusercontent.com/p7kWbWBFxQIrzolEqiV5uSvctLeyssZvBV7UBOX29wzZI52IdcSs4qCB_zsQJL1mt9A" alt="Geometry Dash Lite">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="FNAFWORLD" data-category="horror">
      <p class="game-name">FNAF World</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSQ4aXQb7ab14NFxtfCOjHT2SutBR5R1Hd8lA&s" alt="FNAF World">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="UCN" data-category="horror">
      <p class="game-name">Ultimate Custom Night</p>
      <img src="https://play-lh.googleusercontent.com/pB7dsLLcRgADtFpEPeKc5mSyAn1E1JzrdQ1V7-Y5hizgub3G8e9UJIc5opC9mYXKSBw" alt="Ultimate Custom Night">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="FTF1" data-category="horror">
      <p class="game-name">Fears to Fathom: Home Alone</p>
      <img src="https://sc.filehippo.net/images/t_app-icon-l/p/1056243c-a2c2-4903-9fda-1624d6d9ccfa/3410788382/fears-to-fathom-fears-to-fathom-icn.png" alt="Fears to Fathom: Home Alone">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="GOI" data-category="puzzle">
      <p class="game-name">Getting Over It</p>
      <img src="https://img.tapimg.net/market/images/b802b957f2287907f8988860dc00bd94.png/appicon?t=1" alt="Getting Over It">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="RIDER" data-category="arcade">
      <p class="game-name">Rider</p>
      <img src="https://play-lh.googleusercontent.com/R9qV0OFI0K-jccD79p5Km8bAfSFRa3yPJyuy88a5D6MTeOJEbX_93n-sjHnPs2aN_1A">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="HILLCLIMB" data-category="arcade">
      <p class="game-name">Hill Climb Racing</p>
      <img src="https://img.poki-cdn.com/cdn-cgi/image/q=78,scq=50,width=314,height=314,fit=cover,f=auto/b87616bb88c0e3cb4c150c59fdc767fa/hill-climb-racing-lite.png">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="HOLEIO" data-category="arcade">
      <p class="game-name">Hole.io</p>
      <img src="https://upload.wikimedia.org/wikipedia/en/c/ca/Hole.io_logo.jpg">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="GROW" data-category="simulator">
      <p class="game-name">Growden.io</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSQzh9-rTodL-Q8m9QBBD2eDkRYPrbQO9jaqg&s">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="SCHOOLBOY" data-category="puzzle">
      <p class="game-name">Schoolboy Runaway</p>
      <img src="https://play-lh.googleusercontent.com/aeQ9le0YHrdLlPODSyYW9BnSZVR8gaQZH8hlRz9ksMX_hnzzMdw95Fo1zta4Lc726vQ=w240-h480-rw">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="RAFT" data-category="simulator">
      <p class="game-name">Raft</p>
      <img src="https://a.allegroimg.com/original/11bd03/000b4c3f4c239e3e5bb5b8e1d65c/RAFT-NOWA-PELNA-WERSJA-STEAM-PC-PL">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="SLIMERANCHER" data-category="simulator">
      <p class="game-name">Slime Rancher</p>
      <img src="https://upload.wikimedia.org/wikipedia/en/d/d2/Slime_Rancher_cover_art.png">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="CC3D" data-category="simulator">
      <p class="game-name">Crazy Cattle 3D</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQtgLxY50zDAkOZllI13iHGrgBQm4B8EDANOQ&s">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="DEADSEAT" data-category="horror">
      <p class="game-name">The Deadseat</p>
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT0Uv4XtzrLyHstAEgQWDQ5TD6Uku5QkZKXug&s">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="CRAFT" data-category="simulator">
      <p class="game-name">Infinite Craft</p>
      <img src="https://play-lh.googleusercontent.com/YJFHGSmrMGuUqyWZ0oZDgDtDErIU2jQY3yT_PG9IRL6s5dBLmKXrXQShM3n8HFoPhkM=w240-h480-rw">
      <button class="get-code">Get Code</button>
    </div>
    <div class="game-card" data-code="SNOW" data-category="arcade">
      <p class="game-name">Snow Rider 3D</p>
      <img src="https://spacebartest.org/images/snow-rider-3d-logo.webp">
      <button class="get-code">Get Code</button>
    </div>
  </div>
</div>

<div id="notification"></div>

<script>
const sidebarItems = document.querySelectorAll(".sidebar-item");
const gamesContainer = document.getElementById("games");
const allCards = [...document.querySelectorAll(".game-card")]; // Keep originals
const title = document.getElementById("category-title");
const notification = document.getElementById("notification");
const searchBar = document.getElementById("search-bar");
const moviesBtn = document.getElementById("movies-btn");
const moviesLink = "https://tinkleparty.github.io/host/cinema";
  
let clickData = JSON.parse(localStorage.getItem("clickData")) || {};

/* --- Copy Buttons --- */
function attachButtonEvents(container = document) {
  container.querySelectorAll(".get-code").forEach(btn => {
    btn.addEventListener("click", () => {
      const card = btn.closest(".game-card");
      const code = card.dataset.code;
      const name = card.querySelector(".game-name").textContent;
      clickData[name] = (clickData[name] || 0) + 1;
      localStorage.setItem("clickData", JSON.stringify(clickData));

      navigator.clipboard.writeText(code)
        .then(() => showNotification("Copied! Code: " + code, true))
        .catch(() => showNotification("Failed to copy code", false));

      if (document.querySelector(".sidebar-item.active").dataset.category === "popular") {
        showPopular();
      }
    });
  });
}

/* --- Notification --- */
function showNotification(message, success = true) {
  notification.textContent = message;
  notification.className = success ? "success" : "error";
  notification.style.display = "block";
  setTimeout(() => notification.style.display = "none", 3000);
}

/* --- Show Category --- */
function showCategory(category) {
  gamesContainer.innerHTML = "";
  let filtered = allCards.filter(c => category === "all" || c.dataset.category === category);
  filtered.forEach(c => gamesContainer.appendChild(c));
  attachButtonEvents(gamesContainer);
}

/* --- Most Popular --- */
function showPopular() {
  const ranked = allCards
    .map(card => {
      const name = card.querySelector(".game-name").textContent;
      return { card, count: clickData[name] || 0 };
    })
    .filter(e => e.count > 0)
    .sort((a, b) => b.count - a.count)
    .slice(0, 5);

  gamesContainer.innerHTML = "";
  ranked.forEach((entry, i) => {
    const clone = entry.card.cloneNode(true);
    const badge = document.createElement("div");
    badge.className = "rank-badge";
    if (i === 0) badge.classList.add("rank-gold");
    else if (i === 1) badge.classList.add("rank-silver");
    else if (i === 2) badge.classList.add("rank-bronze");
    else badge.classList.add("rank-blue");
    badge.textContent = `#${i + 1}`;
    clone.appendChild(badge);
    gamesContainer.appendChild(clone);
  });
  attachButtonEvents(gamesContainer);
}

/* --- New Games --- */
function showNewGames() {
  // Take the last 10 game cards from allCards
  const recent = allCards.slice(-10);
  gamesContainer.innerHTML = "";
  recent.forEach(c => {
    const clone = c.cloneNode(true);
    gamesContainer.appendChild(clone);
  });
  attachButtonEvents(gamesContainer);
}

/* --- Request Games --- */
function showRequestForm() {
  gamesContainer.innerHTML = `
    <div class="form-container">
      <h3 class="form-title">üéÆ Request a Game</h3>
      <form id="request-form" class="form">
        <div class="form-group">
          <input
            type="text"
            id="game"
            name="game"
            placeholder="Enter the game name..."
            required
          />
        </div>

        <button type="submit" class="form-submit-btn">
          Submit Request
        </button>
      </form>
    </div>
  `;

  const form = document.getElementById("request-form");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    const gameName = document.getElementById("game").value.trim();
    if (!gameName) return;


    try {
      await fetch("https://script.google.com/macros/s/AKfycbzeM04a5TJDonO4hj2QkeEinqdviobX2veBbX-IKcUYYV0WJ50ybbmuIeHcO7qiSeH3/exec", {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ game: gameName })
      });
      
      showNotification("‚úÖ Game request submitted!", true);
      form.reset();
    } catch (error) {
      console.error(error);
      showNotification("‚ùå Failed to submit request.", false);
    }
  });
}

  
/* --- Search --- */
function filterSearch(term) {
  const active = document.querySelector(".sidebar-item.active").dataset.category;
  const cards = gamesContainer.querySelectorAll(".game-card");
  term = term.toLowerCase();
  cards.forEach(card => {
    const name = card.querySelector(".game-name").textContent.toLowerCase();
    const match = name.includes(term);
    card.style.display = match ? "flex" : "none";
  });
}

/* --- Sidebar Events --- */
sidebarItems.forEach(item => {
  item.addEventListener("click", () => {
    sidebarItems.forEach(i => i.classList.remove("active"));
    item.classList.add("active");
    title.textContent = item.textContent.replace(/^[^a-zA-Z]+/, "");
    const cat = item.dataset.category;

    if (cat === "popular") showPopular();
    else if (cat === "new") showNewGames();
    else if (cat === "request") showRequestForm();
    else showCategory(cat);

    filterSearch(searchBar.value);
  });
});

searchBar.addEventListener("input", e => filterSearch(e.target.value));

attachButtonEvents();
showCategory("all");

moviesBtn.addEventListener("click", () => {
  const win = window.open("about:blank", "_blank");

  if (win) {
    win.document.write(`
      <html>
        <head><title>Tinkle Party Cinema</title></head>
        <body style="margin:0;background-color:black;">
          <iframe src="${moviesLink}" 
            style="border:none;width:100vw;height:100vh;" 
            allowfullscreen></iframe>
        </body>
      </html>
    `);
    win.document.close();
  } else {
    alert("Please allow pop-ups for this site to open Movies.");
  }
});
</script>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-analytics.js";
  import {
    getDatabase, ref, get, set, onValue, push, onDisconnect
  } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-database.js";
  import { getAuth, signInAnonymously, onAuthStateChanged } 
    from "https://www.gstatic.com/firebasejs/12.4.0/firebase-auth.js";
  
  const firebaseConfig = {
    apiKey: "AIzaSyC-IDS2wfF3ZgVzjwf0cHUazNGolLFhXVQ",
    authDomain: "mostpopular-39c60.firebaseapp.com",
    databaseURL: "https://mostpopular-39c60-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "mostpopular-39c60",
    storageBucket: "mostpopular-39c60.firebasedatabase.app",
    messagingSenderId: "939775132675",
    appId: "1:939775132675:web:7d40bd8fff497c53553a36",
    measurementId: "G-XTTQ03YFN9"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);

  // --- üîê Anonymous Auth (must come before database use) ---
  const auth = getAuth(app);
  signInAnonymously(auth)
    .then(() => console.log("‚úÖ Signed in anonymously"))
    .catch((error) => console.error("‚ùå Auth error:", error));

  onAuthStateChanged(auth, (user) => {
    if (user) {
      console.log("üë§ Anonymous UID:", user.uid);
    }
  });
  
  const db = getDatabase(app);


// --- Sanitize Firebase keys ---
function sanitizeKey(name) {
  return name.replace(/[.#$/\[\]]/g, "_");
}

// --- Increment click count in Firebase ---
async function incrementGameClick(name) {
  const safeKey = sanitizeKey(name);
  const gameRef = ref(db, 'clickData/' + safeKey);
  const snapshot = await get(gameRef);
  const current = snapshot.exists() ? snapshot.val() : 0;
  await set(gameRef, current + 1);
}

// --- Get all click data from Firebase ---
async function getAllClickData() {
  const snapshot = await get(ref(db, 'clickData'));
  return snapshot.exists() ? snapshot.val() : {};
}

// --- Attach copy & click events to buttons ---
window.attachButtonEvents = function(container = document) {
  container.querySelectorAll(".get-code").forEach(btn => {
    btn.addEventListener("click", async () => {
      const card = btn.closest(".game-card");
      const code = card.dataset.code;
      const name = card.querySelector(".game-name").textContent;

      // Firebase increment
      try {
        await incrementGameClick(name);
      } catch (e) {
        console.error("incrementGameClick failed:", e);
      }

      // Copy code to clipboard
      navigator.clipboard.writeText(code)
        .then(() => showNotification("Copied! Code: " + code, true))
        .catch(() => showNotification("Failed to copy code", false));

      // Refresh popular list if active
      if (document.querySelector(".sidebar-item.active").dataset.category === "popular") {
        showPopular();
      }
    });
  });
};

// --- Show top 5 popular games ---
window.showPopular = async function() {
  const clickData = await getAllClickData();
  const ranked = allCards
    .map(card => {
      const name = card.querySelector(".game-name").textContent;
      const safeKey = sanitizeKey(name); // sanitize here too
      return { card, count: clickData[safeKey] || 0 };
    })
    .filter(e => e.count > 0)
    .sort((a, b) => b.count - a.count)
    .slice(0, 5);

  gamesContainer.innerHTML = "";
  ranked.forEach((entry, i) => {
    const clone = entry.card.cloneNode(true);
    const badge = document.createElement("div");
    badge.className = "rank-badge " +
      (i === 0 ? "rank-gold" : i === 1 ? "rank-silver" : i === 2 ? "rank-bronze" : "rank-blue");
    badge.textContent = `#${i + 1}`;
    clone.appendChild(badge);
    gamesContainer.appendChild(clone);
  });

  attachButtonEvents(gamesContainer);
};
  
  const settingsRef = ref(db, "siteSettings");
  const triggerAnnRef = ref(db, "announcementTriggerNow");
  const triggerRef = ref(db, "jumpscareTriggerNow");
  const trollBaseRef = ref(db, "trollTriggers");

  // === Timestamp Guards ===
  let lastAnnounceTriggerTime = 0;
  let lastJumpscareTimestamp = 0;
  let lastCursorChaos = 0;
  let lastCreepySound = 0;
  let lastFlashbang = 0;
  let lastReverseControls = 0;

  let initialAnnounceLoaded = false;
  let initialJumpLoaded = false;
  let initialCursorLoaded = false;
  let initialSoundLoaded = false;
  let initialFlashbangLoaded = false;
  let initialReverseLoaded = false;

  // === Listen for site settings ===
  onValue(settingsRef, (snapshot) => {
    const s = snapshot.val();
    if (!s) return;

    document.body.style.backgroundColor = s.backgroundColor || "#0a0a0a";

    setupBanner();
    const content = document.getElementById("announcement-content");
    if (content) content.innerHTML = s.announcement || "";
  });

  // === Setup Announcement Banner if Missing ===
  function setupBanner() {
    if (document.getElementById("announcement")) return;

    const banner = document.createElement("div");
    banner.id = "announcement";
    banner.style.position = "fixed";
    banner.style.top = "50%";
    banner.style.left = "50%";
    banner.style.transform = "translate(-50%, -50%)";
    banner.style.maxWidth = "80%";
    banner.style.padding = "40px";
    banner.style.borderRadius = "10px";
    banner.style.textAlign = "center";
    banner.style.color = "white";
    banner.style.zIndex = "9999";
    banner.style.background = "rgba(0, 0, 0, 0.85)";
    banner.style.fontSize = "1.5em";
    banner.style.opacity = "0";
    banner.style.transition = "opacity 1s ease";
    banner.style.display = "none";

    const title = document.createElement("h2");
    title.textContent = "üì¢ Announcement";
    title.style.marginBottom = "15px";
    title.style.color = "#FFD700";
    title.style.textShadow = "0 0 10px rgba(255,255,255,0.5)";
    banner.appendChild(title);

    const content = document.createElement("div");
    content.id = "announcement-content";
    banner.appendChild(content);

    document.body.appendChild(banner);
  }

  // === Manual Announcement Trigger ===
  onValue(triggerAnnRef, (snapshot) => {
    const t = snapshot.val();
    if (!t || typeof t.timestamp !== "number") return;

    if (!initialAnnounceLoaded) {
      lastAnnounceTriggerTime = t.timestamp;
      initialAnnounceLoaded = true;
      return;
    }

    if (t.timestamp === lastAnnounceTriggerTime) return;
    lastAnnounceTriggerTime = t.timestamp;

    setupBanner();
    const banner = document.getElementById("announcement");
    const content = document.getElementById("announcement-content");
    if (content) content.innerHTML = t.text || "(no message)";

    banner.style.display = "block";
    setTimeout(() => banner.style.opacity = "1", 50);

    setTimeout(() => {
      banner.style.opacity = "0";
      setTimeout(() => banner.style.display = "none", 1000);
    }, 5000);

    // Optional: clear after use
    set(triggerAnnRef, null);
  });

  // === Manual Jumpscare Trigger ===
  onValue(triggerRef, (snapshot) => {
    const t = snapshot.val();
    if (!t || typeof t.timestamp !== "number") return;

    if (!initialJumpLoaded) {
      lastJumpscareTimestamp = t.timestamp;
      initialJumpLoaded = true;
      return;
    }

    if (t.timestamp === lastJumpscareTimestamp) return;
    lastJumpscareTimestamp = t.timestamp;

    const img = document.createElement("img");
    img.src = t.image;
    img.style.position = "fixed";
    img.style.top = "0";
    img.style.left = "0";
    img.style.width = "100%";
    img.style.height = "100%";
    img.style.objectFit = "cover";
    img.style.zIndex = "10000";
    document.body.appendChild(img);

    setTimeout(() => img.remove(), 1500);

    // Optional: clear after use
    set(triggerRef, null);
  });

  // === Cursor Chaos
  onValue(ref(db, "trollTriggers/cursorChaos"), (snap) => {
    const data = snap.val();
    if (!data || typeof data.timestamp !== "number") return;

    if (!initialCursorLoaded) {
      lastCursorChaos = data.timestamp;
      initialCursorLoaded = true;
      return;
    }

    if (data.timestamp === lastCursorChaos) return;
    lastCursorChaos = data.timestamp;

    document.body.style.cursor = "none";
    setTimeout(() => {
      document.body.style.cursor = "default";
    }, 3000);
  });

  // === creepySound (taco rain / crab rave) and audio playing
  onValue(ref(db, "trollTriggers/creepySound"), (snap) => {
    const data = snap.val();
    if (!data || !data.url || Date.now() - data.timestamp > 10000) return;

    const audio = new Audio(data.url);
    audio.play().catch(console.error);

    // üåÆ Taco rain
    if (data.url.includes("rainingtacos.mp3")) {
      startTacoRain();
    }

    // ü¶Ä Crab rave
    if (data.url.includes("crabrave.mp3")) {
      startCrabRave();
    }
  });

  // === Taco Rain Animation ===
  function startTacoRain() {
    const tacoURL = "https://cdn-icons-png.flaticon.com/512/10342/10342492.png"; // <== your taco image URL
    const rainContainer = document.createElement("div");
    rainContainer.id = "taco-rain";
    rainContainer.style.position = "fixed";
    rainContainer.style.top = "0";
    rainContainer.style.left = "0";
    rainContainer.style.width = "100%";
    rainContainer.style.height = "100%";
    rainContainer.style.pointerEvents = "none";
    rainContainer.style.overflow = "hidden";
    rainContainer.style.zIndex = "99999";
    document.body.appendChild(rainContainer);

    // Generate tacos + spice particles
    const tacoCount = 20;
    const spiceCount = 40;
    for (let i = 0; i < tacoCount; i++) createTaco(rainContainer, tacoURL);
    for (let i = 0; i < spiceCount; i++) createSpice(rainContainer);

    // Remove after song ends (~30s)
    setTimeout(() => rainContainer.remove(), 33000);
  }

  function createTaco(container, tacoURL) {
    const taco = document.createElement("img");
    taco.src = tacoURL;
    taco.style.position = "absolute";
    taco.style.top = "-100px";
    taco.style.left = Math.random() * 100 + "vw";
    taco.style.width = 50 + Math.random() * 50 + "px";
    taco.style.opacity = 0.9;
    taco.style.transform = `rotate(${Math.random() * 360}deg)`;
    taco.style.animation = `tacoFall ${4 + Math.random() * 5}s linear infinite`;
    taco.style.animationDelay = Math.random() * 5 + "s";
    container.appendChild(taco);
  }

  function createSpice(container) {
    const spice = document.createElement("div");
    spice.style.position = "absolute";
    spice.style.top = "-10px";
    spice.style.left = Math.random() * 100 + "vw";
    spice.style.width = "8px";
    spice.style.height = "8px";
    spice.style.borderRadius = "50%";
    spice.style.background = Math.random() > 0.5 ? "#d17f3f" : "#f5c26b"; // taco spice colors
    spice.style.opacity = 0.8;
    spice.style.animation = `spiceFall ${3 + Math.random() * 3}s linear infinite`;
    spice.style.animationDelay = Math.random() * 5 + "s";
    container.appendChild(spice);
  }

  // === CSS Animations ===
  const style = document.createElement("style");
  style.textContent = `
  @keyframes tacoFall {
    0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
    100% { transform: translateY(110vh) rotate(720deg); opacity: 0; }
  }

  @keyframes spiceFall {
    0% { transform: translateY(-10px); opacity: 1; }
    100% { transform: translateY(110vh); opacity: 0; }
  }
  `;
  document.head.appendChild(style);

  function startCrabRave() {
    const crabURL = "https://media3.giphy.com/media/v1.Y2lkPTZjMDliOTUyYXJjYTZ2YWxsdTU4bjZleW0yczdxYmhjcmVjMnJob2cwOHlpNTlieiZlcD12MV9zdGlja2Vyc19zZWFyY2gmY3Q9cw/NitS36ljNxQcfT0QIT/200.gif";
    const pageHeight = Math.max(document.body.scrollHeight, window.innerHeight);
    const raveContainer = document.createElement("div");
    raveContainer.id = "crab-rave";
    Object.assign(raveContainer.style, {
      position: "absolute",
      top: "0",
      left: "0",
      width: "100%",
      height: pageHeight + "px",
      pointerEvents: "none",
      zIndex: "99998",
    });
    document.body.appendChild(raveContainer);

    // === Create full-page spotlights ===
    const spotlight = document.createElement("div");
    Object.assign(spotlight.style, {
      position: "absolute", // scrolls with page
      top: "0",
      left: "0",
      width: "100%",
      height: pageHeight + "px",
      pointerEvents: "none",
      zIndex: "99999",
      background: "radial-gradient(circle at 50% 50%, rgba(255,255,255,0.2) 0%, transparent 70%)",
      mixBlendMode: "screen",
      transition: "background 0.3s ease",
    });
    document.body.appendChild(spotlight);

    // === Create crab crowd ===
    const crabCount = 50;
    for (let i = 0; i < crabCount; i++) {
      const crab = document.createElement("img");
      crab.src = crabURL;
      crab.style.position = "absolute";
      crab.style.transition = "transform 0.2s ease";
      crab.style.willChange = "transform";

      const x = Math.random() * 95 + 2.5;
      const y = Math.random() * pageHeight;

      const scale = 0.3 + Math.random() * 0.4;

      Object.assign(crab.style, {
        left: `${x}%`,
        top: `${y}px`,
        transform: `translate(-50%, 0) scale(${scale})`,
        zIndex: Math.floor(scale * 100),
      });

      raveContainer.appendChild(crab);
    }

    // === Beat sync: page scale + crab bounce + spotlight color ===
    const colors = ["#ff00ff", "#00ffff", "#ffcc00", "#ff69b4", "#00ff00"];
    let beatUp = false;
    let colorIndex = 0;

    const beatInterval = setInterval(() => {
      beatUp = !beatUp;

      // Page scaling bounce
      const scale = beatUp ? 1.03 : 1; // grow slightly on beat
      document.body.style.transform = `scale(${scale})`;
      document.body.style.transformOrigin = "center top";
      document.body.style.transition = "transform 0.2s ease";

      // Spotlight moves randomly
      const spotlightX = Math.random() * 100;
      const spotlightY = Math.random() * 100;
      const color = colors[colorIndex % colors.length];
      colorIndex++;
      spotlight.style.background = `radial-gradient(circle at ${spotlightX}% ${spotlightY}%, ${color}40 0%, transparent 70%)`;

      // Crab bounce per beat
      document.querySelectorAll("#crab-rave img").forEach((crab) => {
        const bounce = `translateY(${beatUp ? -6 : 0}px)`;
        crab.style.transform = crab.style.transform.replace(/translateY\(.*?\)/, "") + ` ${bounce}`;
      });
    }, 480); // ~125 BPM

    // === End effect after ~17s ===
    setTimeout(() => {
      clearInterval(beatInterval);
      document.body.style.transform = "scale(1)";
      raveContainer.remove();
      spotlight.remove();
    }, 17000);
  }

  // === Flashbang
  onValue(ref(db, "trollTriggers/flashbang"), (snap) => {
    const data = snap.val();
    if (!data || typeof data.timestamp !== "number") return;

    if (!initialFlashbangLoaded) {
      lastFlashbang = data.timestamp;
      initialFlashbangLoaded = true;
      return;
    }

    if (data.timestamp === lastFlashbang) return;
    lastFlashbang = data.timestamp;

    const flash = document.createElement("div");
    flash.style.position = "fixed";
    flash.style.top = "0";
    flash.style.left = "0";
    flash.style.width = "100%";
    flash.style.height = "100%";
    flash.style.background = "white";
    flash.style.zIndex = "99999";
    flash.style.transition = "opacity 0.5s ease";
    flash.style.opacity = "1";
    document.body.appendChild(flash);

    setTimeout(() => flash.style.opacity = "0", 200);
    setTimeout(() => flash.remove(), 800);
  });

  // === Reverse Controls
  onValue(ref(db, "trollTriggers/reverseControls"), (snap) => {
    const data = snap.val();
    if (!data || typeof data.timestamp !== "number") return;

    if (!initialReverseLoaded) {
      lastReverseControls = data.timestamp;
      initialReverseLoaded = true;
      return;
    }

    if (data.timestamp === lastReverseControls) return;
    lastReverseControls = data.timestamp;

    const moveHandler = (e) => {
      window.scrollBy(
        (Math.random() - 0.5) * -50,
        (Math.random() - 0.5) * -50
      );
    };
    document.addEventListener("mousemove", moveHandler);
    setTimeout(() => {
      document.removeEventListener("mousemove", moveHandler);
    }, 3000);
  });

  // === üë• Live User Presence Tracking ===
  const usersRef = ref(db, "connectedUsers");
  const myRef = push(usersRef);
  // onDisconnect equivalent:
  const disconnectTask = onDisconnect(myRef);
  disconnectTask.remove();
  set(myRef, true);
</script>
</body>
</html>
